# Overwrite the default configuration to handle the Single Page Application (SPA) routing.

# $uri is a variable that holds the path part of the URL, 
# specifically the part after the domain and port, for example localhost:3000/$uri

server {
    listen 80;
    
    # Where the static files are located: localhost:3000/ â†’ root
    root /usr/share/nginx/html;
    index index.html;

    location / {
        # THE MAGIC LINE:
        # 1. Try to find the specific file requested ($uri)
        # 2. If not found, try to find it as a directory ($uri/)
        # 3. If neither works, serve index.html
        try_files $uri $uri/ /index.html;
    }
}

# NOTE: In the third case, the user sees a 404 page (generated by JS), 
# but the browser technically received a 200 OK status from Nginx.

# In Docker Compose: It is common to configure the Frontend Nginx to "proxy" 
# requests to the backend (to avoid CORS errors).

# In Kubernetes: We stop doing that. We let the Ingress Controller handle the routing/balancing, 
#and let the Frontend container simply serve files.